<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot a matrix of Fecal Indicator Bacteria categories over time by station or bay segment — show_fibmatrix • tbeptools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a matrix of Fecal Indicator Bacteria categories over time by station or bay segment — show_fibmatrix"><meta name="description" content="Plot a matrix of Fecal Indicator Bacteria categories over time by station or bay segment"><meta property="og:description" content="Plot a matrix of Fecal Indicator Bacteria categories over time by station or bay segment"><meta property="og:image" content="https://tbep-tech.github.io/tbeptools/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tbeptools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0.9012</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro.html">Water Quality Data</a></li>
    <li><a class="dropdown-item" href="../articles/tbni.html">Tampa Bay Nekton Index</a></li>
    <li><a class="dropdown-item" href="../articles/tbbi.html">Tampa Bay Benthic Index</a></li>
    <li><a class="dropdown-item" href="../articles/tidalcreeks.html">Tidal Creek Assessment</a></li>
    <li><a class="dropdown-item" href="../articles/seagrasstransect.html">Seagrass Transect Data</a></li>
    <li><a class="dropdown-item" href="../articles/habitatmasterplan.html">Habitat Master Plan</a></li>
    <li><a class="dropdown-item" href="../articles/fib.html">Fecal Indicator Bacteria</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tbep-tech/tbeptools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot a matrix of Fecal Indicator Bacteria categories over time by station or bay segment</h1>
      <small class="dont-index">Source: <a href="https://github.com/tbep-tech/tbeptools/blob/master/R/show_fibmatrix.R" class="external-link"><code>R/show_fibmatrix.R</code></a></small>
      <div class="d-none name"><code>show_fibmatrix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot a matrix of Fecal Indicator Bacteria categories over time by station or bay segment</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">show_fibmatrix</span><span class="op">(</span></span>
<span>  <span class="va">fibdata</span>,</span>
<span>  yrrng <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stas <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bay_segment <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indic <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lagyr <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  subset_wetdry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"wet"</span>, <span class="st">"dry"</span><span class="op">)</span>,</span>
<span>  precipdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  temporal_window <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  wet_threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  txtsz <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  asreact <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nrows <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  family <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  angle <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  plotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fibdata">fibdata<a class="anchor" aria-label="anchor" href="#arg-fibdata"></a></dt>
<dd><p>input data frame as returned by <code><a href="read_importfib.html">read_importfib</a></code>, <code><a href="read_importentero.html">read_importentero</a></code>, or <code><a href="read_importwqp.html">read_importwqp</a></code>, see details</p></dd>


<dt id="arg-yrrng">yrrng<a class="anchor" aria-label="anchor" href="#arg-yrrng"></a></dt>
<dd><p>numeric vector indicating min, max years to include, defaults to range of years in data, see details</p></dd>


<dt id="arg-stas">stas<a class="anchor" aria-label="anchor" href="#arg-stas"></a></dt>
<dd><p>optional vector of stations to include, see details</p></dd>


<dt id="arg-bay-segment">bay_segment<a class="anchor" aria-label="anchor" href="#arg-bay-segment"></a></dt>
<dd><p>optional vector of bay segment names to include, supercedes <code>stas</code> if provided, see details</p></dd>


<dt id="arg-indic">indic<a class="anchor" aria-label="anchor" href="#arg-indic"></a></dt>
<dd><p>character for choice of fecal indicator. Allowable options are <code>fcolif</code> for fecal coliform, or <code>entero</code> for Enterococcus. A numeric column in the data frame must have this name.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>optional numeric for threshold against which to calculate exceedances for the indicator bacteria of choice. If not provided, defaults to 400 for <code>fcolif</code> and 130 for <code>entero</code>.</p></dd>


<dt id="arg-lagyr">lagyr<a class="anchor" aria-label="anchor" href="#arg-lagyr"></a></dt>
<dd><p>numeric for year lag to calculate categories, see details</p></dd>


<dt id="arg-subset-wetdry">subset_wetdry<a class="anchor" aria-label="anchor" href="#arg-subset-wetdry"></a></dt>
<dd><p>character, subset data frame to only wet or dry samples as defined by <code>wet_threshold</code> and <code>temporal_window</code>? Defaults to <code>"all"</code>, which will not subset. If <code>"wet"</code> or <code>"dry"</code> is specified, <code><a href="anlz_fibwetdry.html">anlz_fibwetdry</a></code> is called using the further specified parameters, and the data frame is subsetted accordingly.</p></dd>


<dt id="arg-precipdata">precipdata<a class="anchor" aria-label="anchor" href="#arg-precipdata"></a></dt>
<dd><p>input data frame as returned by <code><a href="read_importrain.html">read_importrain</a></code>. columns should be: station, date (yyyy-mm-dd), rain (in inches). The object <code><a href="catchprecip.html">catchprecip</a></code> has this data from 1995-2023 for select Enterococcus stations. If <code>NULL</code>, defaults to <code><a href="catchprecip.html">catchprecip</a></code>.</p></dd>


<dt id="arg-temporal-window">temporal_window<a class="anchor" aria-label="anchor" href="#arg-temporal-window"></a></dt>
<dd><p>numeric; required if <code>subset_wetdry</code> is not <code>"all"</code>. number of days precipitation should be summed over (1 = day of sample only; 2 = day of sample + day before; etc.)</p></dd>


<dt id="arg-wet-threshold">wet_threshold<a class="anchor" aria-label="anchor" href="#arg-wet-threshold"></a></dt>
<dd><p>numeric; required if <code>subset_wetdry</code> is not <code>"all"</code>. inches accumulated through the defined temporal window, above which a sample should be defined as being from a 'wet' time period</p></dd>


<dt id="arg-txtsz">txtsz<a class="anchor" aria-label="anchor" href="#arg-txtsz"></a></dt>
<dd><p>numeric for size of text in the plot, applies only if <code>tab = FALSE</code>.  Use <code>txtsz = NULL</code> to suppress.</p></dd>


<dt id="arg-asreact">asreact<a class="anchor" aria-label="anchor" href="#arg-asreact"></a></dt>
<dd><p>logical indicating if a <code><a href="https://glin.github.io/reactable/reference/reactable.html" class="external-link">reactable</a></code> object is returned</p></dd>


<dt id="arg-nrows">nrows<a class="anchor" aria-label="anchor" href="#arg-nrows"></a></dt>
<dd><p>if <code>asreact = TRUE</code>, a numeric specifying number of rows in the table</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>optional chr string indicating font family for text labels</p></dd>


<dt id="arg-angle">angle<a class="anchor" aria-label="anchor" href="#arg-angle"></a></dt>
<dd><p>numeric for angle of x-axis text labels</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>numeric for size of the x-axis text labels</p></dd>


<dt id="arg-hjust">hjust<a class="anchor" aria-label="anchor" href="#arg-hjust"></a></dt>
<dd><p>numeric for horizontal justification of x-axis text labels</p></dd>


<dt id="arg-plotly">plotly<a class="anchor" aria-label="anchor" href="#arg-plotly"></a></dt>
<dd><p>logical if matrix is created using plotly</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>numeric for width of the plot in pixels, only applies of <code>plotly = TRUE</code></p></dd>


<dt id="arg-height">height<a class="anchor" aria-label="anchor" href="#arg-height"></a></dt>
<dd><p>numeric for height of the plot in pixels, only applies of <code>plotly = TRUE</code></p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>logical to print warnings about stations with insufficient data, default <code>TRUE</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A static <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></code> object is returned by default. A <code><a href="https://glin.github.io/reactable/reference/reactable.html" class="external-link">reactable</a></code> table is returned if <code>asreact = TRUE</code>.  An interactive <code><a href="https://rdrr.io/pkg/plotly/man/plotly.html" class="external-link">plotly</a></code> object is returned if <code>plotly = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The matrix color codes years and stations based on the likelihood of fecal indicator bacteria concentrations exceeding 400 CFU / 100 mL for Fecal Coliform or 130 CFU / 100 mL for Enterococcus.  Bay segments are used instead of stations if <code>bay_segment</code> is not <code>NULL</code> and the input data are from <code><a href="read_importentero.html">read_importentero</a></code>.  The likelihoods are categorized as A, B, C, D, or E (Microbial Water Quality Assessment or MWQA categories) with corresponding colors, where the breakpoints for each category are &lt;10%, 10-30%, 30-50%, 50-75%, and &gt;75% (right-closed). By default, the results for each year are based on a right-centered window that uses the previous two years and the current year to calculate probabilities from the monthly samples (<code>lagyr = 3</code>).  Methods and rationale for this categorization scheme are provided by the Florida Department of Environmental Protection, Figure 8 in the document at <a href="http://publicfiles.dep.state.fl.us/DEAR/BMAP/Tampa/MST%20Report/Fecal%20BMAP%20DST%20Final%20Report%20--%20June%202008.pdf" class="external-link">http://publicfiles.dep.state.fl.us/DEAR/BMAP/Tampa/MST%20Report/Fecal%20BMAP%20DST%20Final%20Report%20--%20June%202008.pdf</a> and Morrison et al. 2009 in the <a href="https://drive.google.com/file/d/1vaoAKkwSLlIS2RzeBeCTjQST1dUmo0rr/view" class="external-link">BASIS 5 proceedings</a>.</p>
<p>The default stations for fecal coliform data are those used in TBEP report #05-13 (<a href="https://drive.google.com/file/d/1MZnK3cMzV7LRg6dTbCKX8AOZU0GNurJJ/view" class="external-link">https://drive.google.com/file/d/1MZnK3cMzV7LRg6dTbCKX8AOZU0GNurJJ/view</a>) for the Hillsborough River Basin Management Action Plan (BMAP) subbasins if <code>bay_segment</code> is <code>NULL</code> and the input data are from <code><a href="read_importfib.html">read_importfib</a></code>.  These include Blackwater Creek (WBID 1482, EPC stations 143, 108), Baker Creek (WBID 1522C, EPC station 107), Lake Thonotosassa (WBID 1522B, EPC stations 135, 118), Flint Creek (WBID 1522A, EPC station 148), and the Lower Hillsborough River (WBID 1443E, EPC stations 105, 152, 137).  Other stations can be plotted using the <code>stas</code> argument.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">show_fibmatrix</span><span class="op">(</span><span class="va">fibdata</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="show_fibmatrix-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># change the threshold</span></span></span>
<span class="r-in"><span><span class="fu">show_fibmatrix</span><span class="op">(</span><span class="va">fibdata</span>, threshold <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="show_fibmatrix-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># change the indicator</span></span></span>
<span class="r-in"><span><span class="fu">show_fibmatrix</span><span class="op">(</span><span class="va">fibdata</span>, indic <span class="op">=</span> <span class="st">'entero'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="show_fibmatrix-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show matrix for only dry samples</span></span></span>
<span class="r-in"><span><span class="fu">show_fibmatrix</span><span class="op">(</span><span class="va">enterodata</span>, indic <span class="op">=</span> <span class="st">'entero'</span>, lagyr <span class="op">=</span> <span class="fl">1</span>, subset_wetdry <span class="op">=</span> <span class="st">"dry"</span>,</span></span>
<span class="r-in"><span>               temporal_window <span class="op">=</span> <span class="fl">2</span>, wet_threshold <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Stations with insufficient data for lagyr: 21FLPDEM_WQX-05-06</span>
<span class="r-plt img"><img src="show_fibmatrix-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcus Beck, Meagan Schrandt, Mike Wessel, Ed Sherwood, Gary Raulerson, Adhokshaja Achar Budihal Prasad, Benjamin Best, Kim Cressman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

